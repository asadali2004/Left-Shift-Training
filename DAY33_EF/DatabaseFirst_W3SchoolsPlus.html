<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EF Core Database-First (Scaffold) – Step-by-step (W3Schools-Plus)</title>

  <!-- Optional: Bootstrap (CDN) for preview -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* W3Schools-Plus-ish UI (kept simple for preview) */
    :root { --tg-accent: #1b6ec2; --tg-soft: rgba(27,110,194,.08); }
    body { background: #fff; }
    .tg-hero { background: linear-gradient(180deg, var(--tg-soft), #fff); border: 1px solid rgba(0,0,0,.06); }
    .tg-badge { background: var(--tg-accent); }
    .tg-kbd { border:1px solid rgba(0,0,0,.18); border-bottom-width:2px; padding:.05rem .35rem; border-radius:.35rem; background:#fff; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .tg-card { border:1px solid rgba(0,0,0,.08); border-radius: 16px; }
    .tg-card:hover { border-color: rgba(27,110,194,.45); box-shadow: 0 .35rem 1.25rem rgba(27,110,194,.10); }
    pre { background: #0b1020; color: #e8eefc; padding: 14px 16px; border-radius: 12px; overflow:auto; }
    code { color: inherit; }
    .tg-step { border-left: 4px solid var(--tg-accent); padding-left: 12px; }
    .tg-note { background: #fff7e6; border: 1px solid rgba(255,193,7,.35); border-radius: 12px; padding: 12px 14px; }
    .tg-tip { background: #eaf8ff; border: 1px solid rgba(13,202,240,.35); border-radius: 12px; padding: 12px 14px; }
    .tg-danger { background: #ffecec; border: 1px solid rgba(220,53,69,.25); border-radius: 12px; padding: 12px 14px; }
    .tg-qa details { border:1px dashed rgba(0,0,0,.22); border-radius:12px; padding:10px 12px; background:#fff; }
    .tg-qa summary { cursor:pointer; font-weight:600; }
    .tg-mini { font-size: .92rem; color: rgba(0,0,0,.72); }
    .tg-diagram { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#fbfbfd; border:1px solid rgba(0,0,0,.08); border-radius:12px; padding:12px 14px; overflow:auto; }
    .tg-copy { float:right; font-size:.85rem; }
  </style>
</head>
<body>
  <header class="container py-4">
    <div class="p-4 tg-hero rounded-4">
      <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
        <div>
          <h1 class="mb-1">EF Core Database-First (Scaffolding) – Step-by-step</h1>
          <div class="tg-mini">Goal: Generate EF Core models + DbContext from an existing database, then query data in ASP.NET Core MVC.</div>
        </div>
        <span class="badge tg-badge rounded-pill px-3 py-2">W3Schools-Plus</span>
      </div>
      <hr class="my-3">
      <div class="d-flex flex-wrap gap-2">
        <a class="btn btn-sm btn-primary" href="#what">What is Database-First?</a>
        <a class="btn btn-sm btn-outline-primary" href="#flow">How it Works (Diagram)</a>
        <a class="btn btn-sm btn-outline-primary" href="#steps">Step-by-step</a>
        <a class="btn btn-sm btn-outline-primary" href="#demo">Mini Demo</a>
        <a class="btn btn-sm btn-outline-primary" href="#errors">Common Errors</a>
        <a class="btn btn-sm btn-outline-primary" href="#mcq">MCQs</a>
        <a class="btn btn-sm btn-outline-primary" href="#interview">Interview Q&A</a>
      </div>
    </div>
  </header>

  <main class="container pb-5">

    <section id="what" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">1) What is Database-First?</h2>
        <p>
          <b>Database-First</b> means your <b>database already exists</b> (tables, columns, keys, relationships).
          You then generate C# classes (<b>entities</b>) and a <b>DbContext</b> from that database.
        </p>

        <div class="tg-note">
          <b>When do we use it?</b>
          <ul class="mb-0">
            <li>You are joining an existing project where the database is already designed.</li>
            <li>DB team controls schema and you want code to match it.</li>
            <li>Legacy systems where tables already exist.</li>
          </ul>
        </div>

        <div class="mt-3 tg-tip">
          <b>Key term:</b> <span class="tg-kbd">Scaffolding</span> = generating code from database schema.
        </div>
      </div>
    </section>

    <section id="flow" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">2) How it Works (Simple Diagram)</h2>
        <div class="tg-diagram">
<pre style="background:transparent;color:inherit;padding:0;margin:0">
Existing Database (Tables + Keys)
        |
        |  EF Core Scaffold / Reverse Engineer
        v
Models (Entities)  +  DbContext
        |
        |  Use in ASP.NET Core MVC
        v
Controllers  ->  Views  ->  Pages (UI)
</pre>
        </div>
        <p class="mt-3 mb-0 tg-mini">
          You do NOT manually create entity classes first. EF generates them from the DB schema.
        </p>
      </div>
    </section>

    <section id="prereq" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">3) Prerequisites</h2>
        <ul>
          <li>.NET SDK installed (example: .NET 6/7/8)</li>
          <li>An existing database (SQL Server shown here)</li>
          <li>Project type: ASP.NET Core MVC</li>
        </ul>

        <div class="tg-tip">
          <b>Two ways to scaffold:</b>
          <ol class="mb-0">
            <li><b>CLI (recommended)</b> – dotnet ef</li>
            <li><b>Visual Studio</b> – “Scaffold-DbContext” via Package Manager Console</li>
          </ol>
        </div>
      </div>
    </section>

    <section id="steps" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">4) Step-by-step (Database-First using CLI)</h2>

        <div class="tg-step mb-3">
          <h3 class="h6 mb-1">Step 1: Create MVC project</h3>
          <pre><code>dotnet new mvc -n DbFirstDemo
cd DbFirstDemo</code></pre>
        </div>

        <div class="tg-step mb-3">
          <h3 class="h6 mb-1">Step 2: Add EF Core packages</h3>
          <p class="tg-mini mb-2">For SQL Server provider:</p>
          <pre><code>dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Tools</code></pre>

          <div class="tg-note mt-2">
            <b>Why tools?</b> Tools package enables scaffolding commands and migrations tooling.
          </div>
        </div>

        <div class="tg-step mb-3">
          <h3 class="h6 mb-1">Step 3: Install EF CLI tool (if not already)</h3>
          <pre><code>dotnet tool install --global dotnet-ef
dotnet ef --version</code></pre>
          <div class="tg-tip mt-2">
            If it says “already installed”, you can skip the install line.
          </div>
        </div>

        <div class="tg-step mb-3">
          <h3 class="h6 mb-1">Step 4: Prepare a connection string</h3>
          <p class="tg-mini mb-2">
            Example for local SQL Server (change server/db/user/password as per your machine).
          </p>
          <pre><code>Server=localhost;Database=FoodieAppDb;Trusted_Connection=True;TrustServerCertificate=True;</code></pre>
          <div class="tg-danger mt-2">
            <b>Tip:</b> Don’t hardcode passwords in source control. Use User Secrets or environment variables.
          </div>
        </div>

        <div class="tg-step mb-3">
          <h3 class="h6 mb-1">Step 5: Scaffold (Reverse Engineer)</h3>
          <p class="tg-mini mb-2">This generates Entities + DbContext.</p>
          <pre><code>dotnet ef dbcontext scaffold ^
  "Server=localhost;Database=FoodieAppDb;Trusted_Connection=True;TrustServerCertificate=True;" ^
  Microsoft.EntityFrameworkCore.SqlServer ^
  --context FoodieAppDbContext ^
  --output-dir Models ^
  --context-dir Data ^
  --use-database-names ^
  --no-pluralize</code></pre>

          <div class="tg-note mt-2">
            <b>What these flags mean:</b>
            <ul class="mb-0">
              <li><b>--output-dir Models</b> → entity classes go to Models folder</li>
              <li><b>--context-dir Data</b> → DbContext goes to Data folder</li>
              <li><b>--use-database-names</b> → keep table/column names closer to DB</li>
              <li><b>--no-pluralize</b> → avoid “Students” becoming “Studentss” type issues</li>
            </ul>
          </div>
        </div>

        <div class="tg-step mb-0">
          <h3 class="h6 mb-1">Step 6: Register DbContext in Program.cs</h3>
          <p class="tg-mini mb-2">Add this inside builder.Services:</p>
          <pre><code>using DbFirstDemo.Data;
using Microsoft.EntityFrameworkCore;

builder.Services.AddDbContext&lt;FoodieAppDbContext&gt;(options =&gt;
    options.UseSqlServer(builder.Configuration.GetConnectionString("FoodieAppDb")));</code></pre>

          <p class="tg-mini mb-2">And in <b>appsettings.json</b>:</p>
          <pre><code>{
  "ConnectionStrings": {
    "FoodieAppDb": "Server=localhost;Database=FoodieAppDb;Trusted_Connection=True;TrustServerCertificate=True;"
  }
}</code></pre>
        </div>
      </div>
    </section>

    <section id="demo" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">5) Mini Demo (Controller + View)</h2>
        <p>Assume you scaffolded a table: <b>Restaurants</b>.</p>

        <div class="row g-3">
          <div class="col-lg-6">
            <div class="p-3 border rounded-4">
              <h3 class="h6">Controller: RestaurantsController.cs</h3>
              <pre><code>using DbFirstDemo.Data;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;

public class RestaurantsController : Controller
{
    private readonly FoodieAppDbContext _db;
    public RestaurantsController(FoodieAppDbContext db) =&gt; _db = db;

    public async Task&lt;IActionResult&gt; Index()
    {
        // Read from DB using scaffolded DbSet
        var list = await _db.Restaurants
                            .AsNoTracking()
                            .OrderBy(r =&gt; r.Name)
                            .ToListAsync();

        return View(list);
    }
}</code></pre>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="p-3 border rounded-4">
              <h3 class="h6">View: Views/Restaurants/Index.cshtml</h3>
              <pre><code>@model IEnumerable&lt;DbFirstDemo.Models.Restaurants&gt;

&lt;h2&gt;Restaurants&lt;/h2&gt;

&lt;table class="table table-striped"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Id&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;City&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
  @foreach (var r in Model)
  {
      &lt;tr&gt;
        &lt;td&gt;@r.Id&lt;/td&gt;
        &lt;td&gt;@r.Name&lt;/td&gt;
        &lt;td&gt;@r.City&lt;/td&gt;
      &lt;/tr&gt;
  }
  &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
            </div>
          </div>
        </div>

        <div class="tg-tip mt-3">
          <b>Best practice:</b> Use <span class="tg-kbd">AsNoTracking()</span> for read-only lists to improve performance.
        </div>
      </div>
    </section>

    <section id="errors" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">6) Common Errors + Fix</h2>

        <div class="accordion" id="accErrors">
          <div class="accordion-item">
            <h2 class="accordion-header" id="e1">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c1">
                “dotnet ef” not recognized
              </button>
            </h2>
            <div id="c1" class="accordion-collapse collapse" data-bs-parent="#accErrors">
              <div class="accordion-body">
                Install tool: <span class="tg-kbd">dotnet tool install --global dotnet-ef</span><br/>
                Restart terminal after installing.
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <h2 class="accordion-header" id="e2">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c2">
                Login failed / cannot open database
              </button>
            </h2>
            <div id="c2" class="accordion-collapse collapse" data-bs-parent="#accErrors">
              <div class="accordion-body">
                Check:
                <ul class="mb-0">
                  <li>Server name: localhost / . / (localdb)\MSSQLLocalDB</li>
                  <li>Database exists</li>
                  <li>Windows auth vs SQL auth (Trusted_Connection vs User Id/Password)</li>
                  <li>Add <span class="tg-kbd">TrustServerCertificate=True</span> if SSL cert errors</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <h2 class="accordion-header" id="e3">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#c3">
                Entities missing relationships (navigation properties)
              </button>
            </h2>
            <div id="c3" class="accordion-collapse collapse" data-bs-parent="#accErrors">
              <div class="accordion-body">
                Ensure foreign keys exist in DB. EF scaffolding relies on real PK/FK constraints.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="mcq" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">7) Quick MCQs (Self-check)</h2>

        <div class="row g-3">
          <div class="col-lg-6">
            <div class="p-3 border rounded-4 tg-qa">
              <p class="mb-1"><b>Q1.</b> In Database-First, what is created first?</p>
              <details>
                <summary>Show Answer</summary>
                <div class="mt-2">
                  The <b>database schema</b> (tables/keys) exists first. Then we scaffold entities + DbContext from it.
                </div>
              </details>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="p-3 border rounded-4 tg-qa">
              <p class="mb-1"><b>Q2.</b> What does scaffolding generate?</p>
              <details>
                <summary>Show Answer</summary>
                <div class="mt-2">
                  <b>Entity classes</b> and a <b>DbContext</b> based on the existing DB schema.
                </div>
              </details>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="p-3 border rounded-4 tg-qa">
              <p class="mb-1"><b>Q3.</b> Which is best for listing read-only data?</p>
              <details>
                <summary>Show Answer</summary>
                <div class="mt-2">
                  Use <span class="tg-kbd">AsNoTracking()</span> for better performance on read-only queries.
                </div>
              </details>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="p-3 border rounded-4 tg-qa">
              <p class="mb-1"><b>Q4.</b> Why might navigation properties be missing?</p>
              <details>
                <summary>Show Answer</summary>
                <div class="mt-2">
                  Because the DB may not have proper <b>PK/FK constraints</b>. EF scaffolding depends on them.
                </div>
              </details>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="interview" class="mb-4">
      <div class="tg-card p-4">
        <h2 class="h4">8) Interview Q&A (Freshers)</h2>

        <div class="tg-qa d-grid gap-3">
          <details>
            <summary>What is DbContext?</summary>
            <div class="mt-2">
              DbContext is a class that represents a session with the database. It contains DbSet properties for tables and
              is used to query and save data.
            </div>
          </details>

          <details>
            <summary>What is DbSet?</summary>
            <div class="mt-2">
              DbSet represents a table (or entity collection). Example: <span class="tg-kbd">_db.Restaurants</span>.
            </div>
          </details>

          <details>
            <summary>Database-First vs Code-First?</summary>
            <div class="mt-2">
              <b>Database-First:</b> DB exists first → generate code. <br/>
              <b>Code-First:</b> Write entities first → migrations create/update DB.
            </div>
          </details>

          <details>
            <summary>How do you re-scaffold after DB changes?</summary>
            <div class="mt-2">
              Run the scaffold command again. Many teams keep entities in a separate folder and regenerate when DB changes.
              Be careful: regeneration can overwrite custom changes.
            </div>
          </details>
        </div>
      </div>
    </section>

    <section id="practice" class="mb-5">
      <div class="tg-card p-4">
        <h2 class="h4">9) Hands-on Practice Tasks</h2>
        <ol>
          <li>Create an MVC project and scaffold 2 tables (with a FK relationship).</li>
          <li>Build one listing page using <span class="tg-kbd">AsNoTracking()</span>.</li>
          <li>Add a search box to filter by Name (starts with / contains).</li>
          <li>Add paging (take 10 records per page).</li>
        </ol>

        <div class="tg-note mb-0">
          <b>Trainer tip:</b> When DB team changes schema, do <b>re-scaffold</b> and then re-apply your UI changes (views/controllers).
        </div>
      </div>
    </section>

  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
